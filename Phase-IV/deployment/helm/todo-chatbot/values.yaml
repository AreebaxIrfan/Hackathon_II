# Default values for todo-chatbot Helm chart

# Backend configuration
backend:
  replicaCount: 1

  image:
    repository: todo-backend
    tag: latest
    pullPolicy: Never  # Use Never for local Minikube images

  service:
    type: ClusterIP
    port: 8000
    targetPort: 8000

  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi

  livenessProbe:
    httpGet:
      path: /health
      port: 8000
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3

  readinessProbe:
    httpGet:
      path: /health
      port: 8000
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3

  env:
    # Database connection (from secret)
    - name: DATABASE_URL
      valueFrom:
        secretKeyRef:
          name: database-secret
          key: DATABASE_URL
    # OpenAI API key (from secret)
    - name: OPENAI_API_KEY
      valueFrom:
        secretKeyRef:
          name: api-keys-secret
          key: OPENAI_API_KEY
    # Better Auth secret (from secret)
    - name: BETTER_AUTH_SECRET
      valueFrom:
        secretKeyRef:
          name: api-keys-secret
          key: BETTER_AUTH_SECRET

# Frontend configuration
frontend:
  replicaCount: 1

  image:
    repository: todo-frontend
    tag: latest
    pullPolicy: Never  # Use Never for local Minikube images

  service:
    type: LoadBalancer
    port: 3000
    targetPort: 3000

  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

  livenessProbe:
    httpGet:
      path: /
      port: 3000
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3

  readinessProbe:
    httpGet:
      path: /
      port: 3000
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3

  env:
    - name: NEXT_PUBLIC_API_URL
      value: "http://backend-service:8000"
    - name: NODE_ENV
      value: "production"

# Ingress configuration
ingress:
  enabled: false
  className: nginx
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: todo-chatbot.local
      paths:
        - path: /
          pathType: Prefix
          service: frontend-service
          port: 3000
        - path: /api
          pathType: Prefix
          service: backend-service
          port: 8000
  tls: []
    # - secretName: todo-chatbot-tls
    #   hosts:
    #     - todo-chatbot.local

# Global settings
nameOverride: ""
fullnameOverride: ""

# Pod annotations
podAnnotations: {}

# Pod security context
podSecurityContext: {}
  # fsGroup: 2000

# Container security context
securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity: {}

# Extra volumes and volume mounts (for configurable storage, etc.)
extraVolumes: []
  # - name: extra-volume
  #   emptyDir: {}

extraVolumeMounts: []
  # - name: extra-volume
  #   mountPath: /extra
  #   readOnly: false

# Auto-scaling configuration (HPA)
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 5
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80
